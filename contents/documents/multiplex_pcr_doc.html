<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multiplex PCR - PrimerWeaver</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            max-width: 1000px;
            margin: 40px auto;
            padding: 20px;
            color: #333;
            background: #f9fafb;
        }
        .container {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 {
            color: #1e40af;
            border-bottom: 3px solid #2563eb;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }
        h2 {
            color: #2563eb;
            margin-top: 2em;
            margin-bottom: 1em;
            font-size: 1.5em;
        }
        h3 {
            color: #3b82f6;
            margin-top: 1.5em;
            margin-bottom: 0.8em;
            font-size: 1.2em;
        }
        h4 {
            color: #60a5fa;
            margin-top: 1.2em;
            margin-bottom: 0.6em;
        }
        p {
            margin-bottom: 1em;
            text-align: justify;
        }
        ul, ol {
            margin-left: 25px;
            margin-bottom: 1em;
        }
        li {
            margin-bottom: 0.5em;
        }
        strong {
            color: #1e40af;
            font-weight: 600;
        }
        code {
            background: #f1f5f9;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #c2410c;
        }
        pre {
            background: #1e293b;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1em 0;
        }
        pre code {
            background: transparent;
            color: inherit;
            padding: 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5em 0;
            font-size: 0.95em;
        }
        th, td {
            border: 1px solid #e2e8f0;
            padding: 12px;
            text-align: left;
        }
        th {
            background: #f1f5f9;
            color: #1e40af;
            font-weight: 600;
        }
        tr:nth-child(even) {
            background: #f8fafc;
        }
        .abstract {
            background: #eff6ff;
            border-left: 4px solid #2563eb;
            padding: 20px;
            margin: 2em 0;
            border-radius: 4px;
        }
        .abstract p {
            margin: 0;
            font-style: italic;
        }
        .highlight {
            background: #fef3c7;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .section {
            margin-bottom: 2.5em;
        }
        .info-box {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
            padding: 15px;
            margin: 1.5em 0;
            border-radius: 4px;
        }
        .warning-box {
            background: #fff7ed;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin: 1.5em 0;
            border-radius: 4px;
        }
        .version-info {
            text-align: center;
            color: #64748b;
            font-size: 0.9em;
            margin-top: 3em;
            padding-top: 2em;
            border-top: 1px solid #e2e8f0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Multiplex PCR Module Documentation</h1>
        
        <div class="abstract">
            <p>The Multiplex PCR module provides comprehensive tools for designing and validating primer sets that can simultaneously amplify multiple DNA target sequences in a single reaction. The module automates primer design with integrated thermodynamic analysis, cross-dimer conflict detection, off-target amplification screening, and intelligent graph-based pooling strategies. A unified conflict graph considers three factors—primer-primer thermodynamic interactions, PCR product size resolution on gels, and shared off-target amplification—to automatically partition primers into non-conflicting pools, each suitable for a separate reaction tube. Interactive heatmap visualizations enable users to assess primer compatibility at a glance.</p>
        </div>

        <div class="section">
            <h2>Quick Start Guide</h2>

	    <ol>
		<li>Upload or paste your target amplification sequences or pre-designed primer sequencs in FASTA or plain text format into the input fields with the correct design mode (De Novo Design Mode or QC mode). Verify and adjust design parameters if necessary.

            <div style="text-align: center; margin: 2em 0;">
                <img
                    src="contents/pictures/multiplex_PCR_demo.png"
                    style="max-width: 90%; height: auto; border-radius: 8px;"
                >
            </div>
                <li>Click “Design Primers” to initiate automated primer design and quality assessment. Review primer QC metrics, pooling recommendations, and the primer–primer interaction heatmap. Download primers by pool in FASTA format and analyze them locally.</li>

            </ol>
        </div>

        <div class="section">
            <h2>Multiplex PCR Principle</h2>
            
            <p>Multiplex PCR simultaneously amplifies multiple DNA targets in a single reaction, significantly improving experimental efficiency and throughput. However, this advantage introduces the critical challenge of managing complex interactions within the reaction mixture. Unlike singleplex PCR, multiplex reactions involve multiple primer pairs with diverse thermodynamic properties, creating numerous opportunities for mispriming, primer dimer formation, and amplification bias that must be carefully controlled. In addition to primer–primer interactions, multiplex PCR must also contend with competition among different primer pairs for shared reagents, as well as unintended primer–target and target–target interactions arising from sequence similarity or uneven amplification efficiencies.</p>
             <div style="text-align: center; margin: 2em 0;">
                <img
                    src="contents/pictures/multiplex_PCR.png"
                    alt="Multiplex PCR Principle"
                    style="max-width: 70%; height: auto; border-radius: 8px;"
                >
            </div>

            <h3>Key Design Considerations</h3>
            <ul>
                <li><strong>Primer–Primer Compatibility:</strong> All primers within the same pool must exhibit minimal thermodynamic interactions. Strong primer–primer complementarity, particularly involving 3′ ends, can lead to dimer formation that consumes primers and suppresses target amplification.</li>
                <li><strong>Product Size Discriminability:</strong> Amplicons within a multiplex reaction should differ sufficiently in length to allow unambiguous separation and identification by gel electrophoresis or downstream detection methods. Products with highly similar sizes are avoided within the same pool to prevent ambiguous interpretation.</li>
                <li><strong>Target Specificity and Competition:</strong> Primers must amplify their intended targets specifically without generating shared off-target products. Competition among primer pairs for reagents and unintended primer–target or target–target interactions can introduce amplification bias and must be minimized through careful pooling.</li>
            </ul>


        <div class="section">
            <h2>Input Format</h2>

	    <p>Both <strong>De Novo Design Mode</strong> and <strong>QC mode</strong> accept <strong>multi-FASTA or plain text format</strong>. The current upload size limit is <strong>1 MB</strong>; however, the user interface may become unstable when processing very large inputs. We therefore recommend limiting each run to <strong>no more than 500 sequences</strong>.<p>

             <div style="text-align: center; margin: 2em 0;">
                <img
                    src="contents/pictures/multiplex_PCR_input.png"
                    alt="Multiplex PCR Input"
                    style="max-width: 70%; height: auto; border-radius: 8px;"
                >
            </div>
	    
           
            
        <div class="section">
            <h2>Design Parameters</h2>
            <p>Before proceeding, please review the <strong>primer design parameters</strong> and adjust them if necessary.</p>

<table>
    <thead>
        <tr>
            <th>Parameter</th>
            <th>Default</th>
            <th>Range</th>
            <th>Description</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><strong>Target Tm (°C)</strong></td>
            <td>55</td>
            <td>40–75</td>
            <td>
                Target melting temperature for the <em>template-binding (annealing) region</em> of primers.
                Primers are designed to have a Tm close to this value. Overlap or adapter sequences are excluded
                from Tm calculation.
            </td>
        </tr>
        <tr>
            <td><strong>ΔTm (°C)</strong></td>
            <td>2.5</td>
            <td>0–5</td>
            <td>
                Maximum allowed melting temperature difference between forward and reverse primers within
                the same primer pair.
            </td>
        </tr>
        <tr>
            <td><strong>Primer Concentration (nM)</strong></td>
            <td>500</td>
            <td>50–2000</td>
            <td>
                Effective primer concentration assumed for in silico Tm calculation. Typical range: 25-1000 nM.
            </td>
        </tr>
        <tr>
            <td><strong>Na⁺ Concentration (mM)</strong></td>
            <td>50</td>
            <td>0–200</td>
            <td>
                Monovalent cation concentration used for salt-corrected Tm calculation. Typical range: 10-200 mM.


            </td>
        </tr>
        <tr>
            <td><strong>Mg²⁺ Concentration (mM)</strong></td>
            <td>2.0</td>
            <td>0–10</td>
            <td>
                Divalent cation concentration used for Tm calculation. Set to 0 if Mg²⁺ is absent from reaction. Typical range: 0.5-5 mM.

            </td>
        </tr>
        <tr>
            <td><strong>Size Tolerance (bp)</strong></td>
            <td>20</td>
            <td>0–50</td>
            <td>
                Minimum product size difference required for reliable resolution by agarose gel electrophoresis.
                Set to 0 to disable size-based pooling (e.g., for qPCR or sequencing-based assays).
            </td>
        </tr>
        <tr>
            <td><strong>Forward Overlap</strong></td>
            <td>—</td>
            <td>Optional</td>
            <td>
                Sequence appended to the 5′ end of forward primers for cloning or assembly applications
                (e.g., Gibson Assembly). This region does not participate in Tm calculation.
            </td>
        </tr>
        <tr>
            <td><strong>Reverse Overlap</strong></td>
            <td>—</td>
            <td>Optional</td>
            <td>
                Sequence appended to the 5′ end of reverse primers for cloning or assembly applications.
                This region does not participate in Tm calculation.
            </td>
        </tr>
    </tbody>
</table>

            
            <div class="info-box">
                <strong>Note on Size Tolerance:</strong>
                <ul style="margin: 8px 0 0 20px;">
                    <li><strong>0 bp:</strong> Disable size-based pooling (for qPCR, sequencing, or when gel electrophoresis is not used)</li>
                    <li><strong>5 bp:</strong> High-resolution gel (2–3% agarose), can distinguish very close bands</li>
                    <li><strong>10–15 bp:</strong> Standard gel (1–2% agarose), reliably distinguishes most bands</li>
                    <li><strong>20 bp:</strong> Default value, suitable for routine gel electrophoresis</li>
                </ul>
            </div>
            
            <div class="warning-box">
                <strong>Important:</strong> In QC mode, size-based pooling is automatically disabled as PCR product length information is not available. Pooling is based solely on thermodynamic parameters.
            </div>
        </div>

        <div class="section">
            <h2>Results and Output</h2>
            
            <p>After primer design or quality control analysis, PrimerWeaver generates comprehensive results including primer tables with quality metrics, pooling recommendations, and interactive visualizations.</p>
            
            <h3>Primer Properties Table</h3>
            <p>Designed or analyzed primer pairs are reported in a structured table, including primer sequences (5′→3′), length, GC content, and melting temperatures (Tm). Tm values are displayed for both the annealing core region and the full-length primer, allowing users to assess amplification compatibility. Primer quality metrics, including homopolymer runs, hairpin structures, self-dimer, and cross-dimer formation, are evaluated and flagged to highlight potential risks that may affect PCR performance. </p>
            
            
            <div style="text-align: center; margin: 2em 0;">
                <img
                    src="contents/pictures/multiplex_PCR_table.png"
                    alt="Multiplex PCR primer table with quality metrics"
                    style="max-width: 70%; height: auto; border-radius: 8px;"
                >
            </div>
        </div>

        <h3>Pooling Recommendations</h3>
        <p>After analyzing all pairwise primer interactions, the module recommends an optimal pooling strategy that partitions primers into the minimum number of reaction tubes. The pooling results indicate whether all primers can be combined into a single reaction or must be split across multiple reactions, and explain why certain primers cannot be pooled together.<p>
    
        <div style="text-align: center; margin: 2em 0;">
            <img
                src="contents/pictures/multiplex_PCR_pooling.png"
                alt="Multiplex PCR pooling recommendations and pool assignments"
                style="max-width: 70%; height: auto; border-radius: 8px;"
            >
        </div>
        </div>

        <div class="section">
            <h3>Primer-Primer Dimer Matrix </h3>
            <p>The module generates interactive heatmap matrices showing all pairwise primer interactions within each pool. The heatmap uses a color gradient to indicate interaction strength based on Gibbs free energy (ΔG). When primers are divided into multiple pools, separate heatmaps are generated for each pool. This allows visual verification that primers within each pool have only weak or negligible interactions.</p>
                     
            <div style="text-align: center; margin: 2em 0;">
                <img
                    src="contents/pictures/multiplex_PCR_heatmap.png"
                    alt="Multiplex PCR primer-primer interaction heatmap visualization"
                    style="max-width: 70%; height: auto; border-radius: 8px;"
                >
            </div>

           
        <div class="section">
            <h2>Primer Design Algorithm</h2>
            
            <h3>Primer Design Process</h3>
            <p>PrimerWeaver employs a <strong>systematic, target-centric workflow</strong> to design <strong>multiplex PCR primers</strong> that satisfy <strong>thermodynamic, structural, and pooling constraints</strong>. For each target sequence, the algorithm scans the <strong>5′ and 3′ termini</strong> to identify candidate primer binding sites that achieve the <strong>user-defined target melting temperature (Tm)</strong> within the specified tolerance. Candidate primers are then evaluated for <strong>intrinsic quality</strong>, including GC content, homopolymer runs, hairpin formation, and self-dimer potential. Optional 5′ overlap sequences for downstream cloning applications are appended after primer selection and are excluded from Tm calculation. For each validated primer pair, the <strong>expected PCR product size</strong> is calculated and retained for downstream pooling analysis.</p>
	    <p>In <strong>De Novo Design Mode</strong>, PrimerWeaver additionally performs <strong>off-target amplification screening</strong> using a seed-and-extend algorithm. Potential non-target binding events require an exact match at the 3′ seed region, while allowing limited mismatches in the upstream 5′ region. All possible non-target amplicons are identified and sized. Primer pairs that amplify the same non-target region or generate indistinguishable products are flagged as conflicting and excluded from the same multiplex pool. <strong>Off-target analysis is not performed in QC mode</strong>, as template sequences are not provided.<p>
            
            <h3>Thermodynamic Modeling and Interaction Evaluation</h3>
            <p>All melting temperature and interaction calculations are based on the <strong>unified nearest-neighbor (NN) thermodynamic model</strong>. Primer melting temperatures are computed using sequence-specific enthalpy (ΔH°) and entropy (ΔS°) parameters, with corrections for salt concentration and effective primer concentration. Self-dimer and cross-dimer stability are evaluated by calculating the Gibbs free energy (ΔG) of potential duplex formation at the PCR annealing temperature, with particular emphasis on 3′-end complementarity, which poses the highest risk for polymerase extension.</p>
            <p>Based on all <strong>pairwise interaction energies</strong>, PrimerWeaver recommends an <strong>optimal pooling strategy</strong> that partitions primers into the <strong>fewest possible PCR reactions</strong> while avoiding strong thermodynamic conflicts. Primer pairs exhibiting <strong>stable primer–primer interactions, insufficient gel size resolution</strong>, or <strong>shared off-target amplification</strong> events are assigned to separate pools. The final output reports both the recommended pooling configuration and the specific constraints preventing incompatible primers from being combined.<p>
                       
                       
                        
            
        </div>


    </div>
</body>
</html>
